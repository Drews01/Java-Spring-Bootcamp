# Penetration Test History

## Overview
- **Engagement Date:** 22 Dec 2025
- **Assessment Type:** Application-layer review (manual code inspection + configuration analysis)
- **Scope:** Spring Boot REST API, authentication/authorization stack, Redis cache layer, SQL Server persistence, Docker-based Redis infrastructure
- **Standards Referenced:** OWASP Top 10 (2021 edition)

## Methodology
1. Reviewed security-sensitive code paths (authentication, authorization, entity controllers/services, configuration).
2. Evaluated configuration files (`application.yml`, Docker instructions) for exposed credentials and insecure defaults.
3. Traced data initialization logic for privilege management and password handling.
4. Mapped each issue to the relevant OWASP Top 10 category and estimated risk/severity based on impact + likelihood.

## Key Findings
| # | Category | Description | Severity | Evidence |
|---|----------|-------------|----------|----------|
| 1 | A01 Broken Access Control | Authenticated users can call any non-`/auth` endpoint with no role/ownership checks; mass assignment of roles via `UserController`. | Critical | [src/main/java/com/example/demo/config/SecurityConfig.java](src/main/java/com/example/demo/config/SecurityConfig.java), [src/main/java/com/example/demo/controller/UserController.java](src/main/java/com/example/demo/controller/UserController.java) |
| 2 | A02 Cryptographic Failures | DB creds and JWT secret committed in plain text; DataInitializer seeds an `admin` user with unhashed password. | High | [src/main/resources/application.yml](src/main/resources/application.yml), [src/main/java/com/example/demo/config/DataInitializer.java](src/main/java/com/example/demo/config/DataInitializer.java) |
| 3 | A05 Security Misconfiguration | No rate limits/CORS; CSRF disabled globally; sample admin always provisioned in all environments. | High | [src/main/java/com/example/demo/config/SecurityConfig.java](src/main/java/com/example/demo/config/SecurityConfig.java), [src/main/java/com/example/demo/config/DataInitializer.java](src/main/java/com/example/demo/config/DataInitializer.java) |
| 4 | A07 Identification & Authentication Failures | Unlimited login attempts, long-lived JWT (24h) without refresh rotation or revocation. | High | [src/main/java/com/example/demo/security/JwtService.java](src/main/java/com/example/demo/security/JwtService.java) |
| 5 | A09 Security Logging & Monitoring Failures | No audit logging for auth events, privilege changes, or cache operations. | Medium | Codebase-wide |
| 6 | A04 Insecure Design / Mass Assignment | Controllers bind entity objects directly without DTO validation, letting clients set server-managed fields. | Medium | [src/main/java/com/example/demo/controller/*Controller.java](src/main/java/com/example/demo/controller) |
| 7 | A02/A03 Input Validation & Injection | User-supplied strings lack `@Valid` constraints, risking stored XSS/cache poisoning in downstream consumers. | Medium | [src/main/java/com/example/demo/controller/ProductController.java](src/main/java/com/example/demo/controller/ProductController.java), [src/main/java/com/example/demo/entity/Product.java](src/main/java/com/example/demo/entity/Product.java) |
| 8 | A08 Software & Data Integrity Failures | Dependencies/images lack signature verification or SCA monitoring. | Low | Build/docs |

## Recommended Remediation Roadmap
1. Enforce method-level authorization with `@PreAuthorize`, implement resource ownership checks, and restrict role manipulation to admins only via dedicated service methods.
2. Externalize all secrets to environment variables or a vault, hash seeded passwords with `PasswordEncoder`, and rotate compromised credentials immediately.
3. Introduce DTO-based request validation (`@Valid`, bean constraints) and remove direct entity binding from controllers.
4. Add rate limiting, account lockouts, shorter JWT TTLs, refresh tokens, and token revocation support.
5. Enable structured security logging (login failures, role changes, cache evictions) and ship logs to a monitored SIEM.
6. Parameterize environment-specific initializers so demo data never ships to production.
7. Integrate dependency scanning (OWASP Dependency-Check, Snyk) and pin trusted container images.

## Status Tracking
- **Remediation Owner:** _Unassigned_
- **Due Date:** _TBD_
- **Next Review:** Schedule follow-up verification once fixes for findings #1-4 are in place.
